clc;clear;
FluxArithPro=0:0.08:0.08*19;    % arithmetic progression,total 20 rows, data of Flux
theta=0:0.72:0.72*31;   % total 32 lines points, the data of theta
Irow32line20=[0	4.479775043	8.95976642	13.43874767	17.91561783	22.38976708	26.86108398	31.34276701	35.81661433	40.2995132	44.80984723	49.30227284	53.79953773	58.84685699	65.08839864	72.36482075	80.15442481	87.93376007	95.17937575	101.3678211
0	4.456763861	8.913708883	13.36971397	17.82357924	22.27471779	26.72302514	31.18238881	35.63438393	40.09176148	44.57816546	49.05493479	53.53550413	58.54688511	64.76423101	72.06612688	79.91499489	87.76965529	95.08892832	101.3316342
0	4.402442164	8.805025822	13.20673905	17.60629387	22.00314876	26.39841308	30.80158038	35.20144269	39.6020357	44.03410383	48.47272996	52.91425379	57.83452654	63.97419263	71.31904752	79.29815055	87.32780987	94.82433362	101.2040299
0	4.312308967	8.624688709	12.93632407	17.24574083	21.55251462	25.85964389	30.16827074	34.48244462	38.79063319	43.13423142	47.51155016	51.90875506	56.69614114	62.68413558	70.06796204	78.24345356	86.55636381	94.35244648	100.9774552
0	4.179757433	8.359495558	12.53866116	16.71546511	20.88972409	25.06539908	29.23283786	33.42609108	37.60116501	41.81885233	46.11056581	50.47173453	55.10826833	60.84370711	68.20739973	76.62504749	85.33656687	93.58187436	100.6008864
0	4.017144865	8.034186201	12.05084342	16.06491625	20.07644309	24.08812919	28.08716916	32.12503619	36.14214791	40.22388327	44.44358968	48.78909763	53.30233943	58.70854492	65.93599748	74.63324153	83.87196252	92.72109213	100.249562
0	3.806900526	7.613641112	11.42021595	15.2238094	19.02499461	22.82590504	26.62327248	30.44917456	34.2934338	38.20947947	42.33839089	46.70274886	51.2281042	56.31581074	63.21972077	72.18099225	82.08738127	91.74438565	99.95750321
0	3.544102886	7.088025654	10.63188442	14.17235222	17.71086724	21.25039624	24.7985296	28.35921144	32.0696827	35.88937442	39.89888194	44.18206647	48.79642805	53.89211838	60.48278069	69.45831126	79.83196261	90.22740349	99.26830264
0	3.238449771	6.476713081	9.71472147	12.94937486	16.18247183	19.41968435	22.68624915	26.04404066	29.60780026	33.34079364	37.32135563	41.61463172	46.29679199	51.46493102	57.73010397	66.44950568	77.15651858	88.26847166	98.18897925
0	2.881951585	5.763669985	8.644614141	11.5232198	14.40102291	17.29670508	20.29001052	23.50875709	27.04926652	30.76264582	34.71142073	38.98779368	43.5752527	48.6976957	54.79872446	63.14933867	74.10755853	85.98804728	96.9311038
0	2.482463579	4.964514845	7.445600425	9.925173974	12.4096659	14.96129197	17.75169181	20.90671204	24.40957394	28.13389256	32.16521294	36.31774928	40.73341494	45.68595265	51.71461014	59.74264634	70.7635229	83.341602	95.36370899
0	2.128946277	4.257394243	6.384752439	8.510602414	10.64937154	12.89995006	15.49191247	18.53758382	21.95775737	25.68172849	29.55169363	33.60142644	37.87503289	42.75160421	48.67939818	56.30577816	67.09807994	80.38544265	93.59922609
0	1.912519543	3.824597039	5.735536691	7.644760916	9.557472782	11.5343494	13.74866452	16.44336652	19.59195502	23.13219941	26.84671642	30.68168034	34.85672959	39.68795173	45.5383618	52.92554706	63.22722236	77.05481208	91.53308433
0	1.739459363	3.478576333	5.216448171	6.952508125	8.685857795	10.44176687	12.31324193	14.51621821	17.25160831	20.52925676	24.08683308	27.7952805	31.79679918	36.43599643	42.23846825	49.64661721	59.42692103	73.36148221	88.95217442
0	1.576328927	3.152362853	4.727152634	6.299674589	7.870202895	9.446120697	11.06896248	12.89887932	15.15898099	18.01995645	21.41754333	24.99754879	28.87725108	33.38468303	38.91688125	46.30402982	55.82278066	69.45487836	86.00483683
0	1.411190631	2.822183804	4.231900713	5.639042695	7.044020417	8.452247364	9.88500524	11.42160453	13.31317096	15.7203936	18.81568048	22.23553519	25.99142389	30.50041086	35.82624622	42.90463552	52.31795113	65.39155926	82.67191082
0	1.288353935	2.576663326	3.86379358	5.147888928	6.429955481	7.713124741	9.006468965	10.35326024	11.88112586	13.82761198	16.37062631	19.58673168	23.21306868	27.53296133	32.74551078	39.61500025	48.85256553	61.2683472	79.02157268
0	1.202245531	2.404566508	3.605949836	4.804008344	5.999628928	7.19582711	8.395747386	9.620033006	10.92703941	12.48300425	14.49958229	17.1676301	20.60256237	24.64899454	29.60037541	36.278589	45.31385406	57.27946476	74.95015031
0	1.125262278	2.250629127	3.375300188	4.496680074	5.614987749	6.733816443	7.854967522	8.983845429	10.15502025	11.4506462	13.05451775	15.17965583	18.08086587	21.89847795	26.59136454	32.9478794	41.76750113	53.50074619	70.67571375
0	1.051270148	2.102568097	3.153310041	4.201090622	5.245222063	6.289686192	7.336848578	8.38542083	9.454400943	10.59470342	11.9161437	13.60877595	15.97027175	19.35374183	23.74559181	29.81363808	38.35428407	49.91728173	66.52314263
0	0.987166763	1.974197638	2.960638817	3.944661027	4.924958317	5.904466567	6.886699721	7.87153875	8.862850772	9.895368091	11.03204713	12.42731152	14.34307944	17.17466096	21.17906894	26.84336202	35.17000917	46.40469732	62.57980215
0	0.933644386	1.867006947	2.799659508	3.73027162	4.657483431	5.583071929	6.510509902	7.441301139	8.375650309	9.330970515	10.34803157	11.52988615	13.09444996	15.48365147	18.91075227	24.11573596	32.09993038	43.00341459	58.80465851
0	0.892110003	1.783838387	2.674738733	3.563814454	4.449887368	5.333900396	6.218868177	7.107076061	7.999211222	8.901660885	9.844416629	10.88484798	12.21962905	14.20245993	17.15353596	21.69953506	29.1664285	39.72908768	55.13668781
0	0.855078199	1.709698673	2.563379331	3.415347952	4.264660986	5.111719303	5.959135609	6.809420546	7.663663575	8.523742971	9.408943353	10.35411193	11.51284972	13.20880426	15.76013782	19.70354204	26.50311236	36.5679994	51.55649524
0	0.811809266	1.623133194	2.433474699	3.242106424	4.048091078	4.85146549	5.655551155	6.464071658	7.276013562	8.086464325	8.90597167	9.790439767	10.82954458	12.31400671	14.51219688	18.03263557	24.24754282	33.63831287	48.24688354
0	0.775115569	1.5497989	2.323607324	3.095733397	3.864918161	4.630595721	5.397139358	6.170954343	6.952135593	7.727438349	8.488222003	9.305737122	10.30664131	11.6646347	13.63548502	16.80730903	22.57909786	31.34693677	45.34635088
0	0.748747945	1.497124664	2.244751768	2.990802627	3.733744941	4.472415138	5.211170362	5.958189632	6.717484472	7.473013722	8.20360478	8.957987359	9.908880241	11.22535407	13.01733649	15.93398657	21.38440171	29.64664604	42.88518746
0	0.721567475	1.442749526	2.163158512	2.88206423	3.598026797	4.309658434	5.02002084	5.737435571	6.469160137	7.204826855	7.921820208	8.628183909	9.505409574	10.7840359	12.50574595	15.24414684	20.42758009	28.34346137	40.99167763
0	0.695708156	1.390846987	2.084847153	2.777127112	3.467071358	4.154070687	4.839437744	5.528487949	6.226941294	6.934342599	7.640397344	8.339297613	9.157930493	10.35997537	12.07077156	14.68595658	19.67980851	27.37247651	39.62298204
0	0.677199237	1.353576323	2.028309127	2.700850442	3.371622744	4.041262227	4.710579501	5.380965454	6.053931933	6.732054556	7.421261605	8.128389996	8.930628342	10.07167252	11.75318713	14.30676082	19.2284802	26.75657129	38.80700307
0	0.673900522	1.346921633	2.018183926	2.687137031	3.354443897	4.021047081	4.687782028	5.35509443	6.023341431	6.694919379	7.37957167	8.088772281	8.892337412	10.02235609	11.68888318	14.22549755	19.11572101	26.59001383	38.52170547
0	0.675815098	1.350785516	2.024066587	2.695115224	3.364471965	4.032920652	4.701259476	5.37033616	6.041009429	6.715823381	7.402939237	8.111843457	8.9160717	10.05144869	11.72252747	14.26143858	19.15451843	26.63467558	38.53953065
];

Wrow32line20=zeros(32,20);  % energy

for k1=1:32 % row    
    Irow32line20Line=Irow32line20(k1,:);
    i_handle=@(x)interp1(FluxArithPro,Irow32line20Line,x,'spline');
    
    for k2=1:19
       %Wrow32line20(k1,k2+1)=quad(i_handle,0,k2*0.08); % integral of the i*d(Psi)
       Wrow32line20(k1,k2+1)=integral(i_handle,0,k2*0.08); % integral of the i*d(Psi) % almost no change with the upper command
    end
end