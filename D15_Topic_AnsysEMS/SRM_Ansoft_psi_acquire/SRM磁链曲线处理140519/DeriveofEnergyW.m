clc;clear;
FluxLine20=0:0.08:0.08*19;    % arithmetic progression,total 20 rows, data of Flux
thetaRow32=0:0.72:0.72*31;   % total 32 lines points, the data of theta
Wrow32line20=[0	0.179185856	0.716769776	1.612722317	2.86690919	4.479160238	6.449150484	8.777293382	11.46370639	14.50818731	17.91245097	21.67735243	25.80013036	30.29964957	35.24881514	40.74167719	46.84079765	53.56613101	60.89596163	68.76664018
0	0.178266216	0.713087049	1.604435784	2.852179898	4.456147747	6.416012369	8.732208837	11.40493144	14.43383029	17.82047539	21.56616644	25.66858445	30.14561893	35.06957203	40.53720345	46.61464132	53.32378301	60.64350253	68.50930335
0	0.176093936	0.704394519	1.584875987	2.817412526	4.401815638	6.337847072	8.625819311	11.26598931	14.25801112	17.60323283	21.30375832	25.35826386	29.78222525	34.64554436	40.0508909	46.07335221	52.73998406	60.03157457	67.88209563
0	0.172489706	0.689971322	1.552421122	2.759724113	4.311660693	6.20814694	8.449220479	11.03528048	13.96612986	17.24279951	20.86862161	24.84472327	29.18356919	33.94907479	39.25140183	45.18084145	51.77407726	59.01606315	66.83924028
0	0.167189237	0.668760674	1.504694569	2.674886483	4.179077105	6.017345531	8.189174361	10.69551905	13.53660712	16.71294027	20.22965654	24.09238832	28.31139358	32.93932684	38.09160592	43.88046593	50.35949035	57.52187466	65.29988915
0	0.160686882	0.642740418	1.446149096	2.570808587	4.016441657	5.783128394	7.869995986	10.2784341	13.00910476	16.06298557	19.44869102	23.17745741	27.25840225	31.72901529	36.70251484	42.31841426	48.6581592	55.72756797	63.45831635
0	0.152279969	0.609099819	1.37046393	2.436250388	3.806198739	5.480278177	7.458151635	9.740880805	12.33041579	15.22957555	18.44979375	22.01021634	25.92611022	30.21998384	34.9867062	40.39194187	46.56049702	53.51936529	61.20109491
0	0.141770151	0.567051659	1.275861444	2.268050112	3.543395575	5.10177895	6.94379559	9.069510913	11.48573759	14.20323034	17.23318711	20.59431867	24.31136012	28.41315164	32.97372128	38.15722402	44.12416521	50.93096062	58.52442838
0	0.129542931	0.518146991	1.165818076	2.072401769	3.237680802	4.661675367	6.345604914	8.29372778	10.51852022	13.03517344	15.85976671	19.01486193	22.52855655	26.43492187	30.79023972	35.7404367	41.47627429	48.09602257	55.56745746
0	0.115279258	0.461106035	1.037448696	1.844177213	2.881137809	4.148726687	5.651175342	7.401064878	9.421706385	11.73306914	14.3500009	17.29594702	20.59581574	24.28244737	28.411831	33.11136877	38.58851358	44.99264946	52.32160227
0	0.099299512	0.397183178	0.893596265	1.588438361	2.48171087	3.575581359	4.881974943	6.425714103	8.236630043	10.33652173	12.7470402	15.48542433	18.56496701	22.01669183	25.9031579	30.34321409	35.54610935	41.7069523	48.86593914
0	0.085159717	0.340618116	0.766314767	1.362133009	2.128276774	3.068771791	4.201549009	5.559893978	7.177380215	9.081538188	11.28989251	13.81485379	16.67147613	19.89091251	23.54002126	27.72258672	32.63694825	38.52708364	45.49665629
0	0.076500407	0.305991339	0.688403587	1.223638694	1.911592886	2.754430147	3.7631963	4.967574272	6.406069143	8.113099715	10.11159819	12.41140801	15.0296963	18.00587676	21.40709736	25.3314692	29.95312407	35.54760582	42.2992454
0	0.069576207	0.278304368	0.626112335	1.112897044	1.738409308	2.503180347	3.411976358	4.482164729	5.748963964	7.257350461	9.040856574	11.11492325	13.49573652	16.21913076	19.35663069	23.02048764	27.35953652	32.6476616	39.1415376
0	0.063052006	0.252204762	0.567396976	1.008488839	1.575282476	2.26785458	3.087736457	4.044336789	5.163080813	6.486012033	8.061237806	9.916784061	12.06863758	14.55417779	17.43607783	20.83290759	24.89643807	29.88081831	36.08702845
0	0.056445893	0.225785235	0.507962362	0.902817773	1.410150635	2.029920622	2.763167685	3.613917517	4.600433644	5.757377883	7.135214707	8.775833564	10.7010248	12.95589411	15.60066515	18.73649738	22.52555939	27.20680299	33.10038876
0	0.051531871	0.206135442	0.463768958	0.824256699	1.287374745	1.853078956	2.521708874	3.295459924	4.182851243	5.207781476	6.411069272	7.845957409	9.554549457	11.57932098	13.98241435	16.86309398	20.38430538	24.76192338	30.32957261
0	0.048087753	0.192361297	0.432797013	0.769219277	1.201369212	1.729182948	2.352773514	3.073137141	3.894021084	4.828052649	5.90364435	7.165308397	8.671558572	10.47730767	12.63876374	15.25967491	18.50720325	22.58411206	27.82405259
0	0.045009168	0.180044753	0.405095358	0.72000065	1.124476871	1.61841595	2.201953285	2.875374004	3.640469376	4.503329891	5.480806342	6.605869605	7.930288515	9.523924338	11.45583814	13.8228873	16.7947305	20.5795341	25.4999622
0	0.04205042	0.168203965	0.378449981	0.67265278	1.050519517	1.511898485	2.056954476	2.685802049	3.399136777	4.200342122	5.099020264	6.116752251	7.293927996	8.700281274	10.41606274	12.5441151	15.25331564	18.75866164	23.37455688
0	0.039487168	0.157943058	0.355345272	0.631581102	0.986384653	1.419552985	1.931176796	2.521499744	3.190742948	3.940654235	4.77664575	5.712602996	6.77861038	8.032243784	9.557733293	11.46369126	13.92619813	17.16483016	21.48269373
0	0.037346856	0.149375586	0.336050293	0.597267676	0.932798095	1.342419776	1.826140444	2.384199785	3.016814624	3.724854856	4.511322323	5.384903413	6.365761916	7.502734454	8.869980894	10.57499504	12.80519124	15.78512273	19.81634408
0	0.035685805	0.142727424	0.321078564	0.57063784	0.891205813	1.282561828	1.744656756	2.277669384	2.881893909	3.557776964	4.307241938	5.135317225	6.056415118	7.107870768	8.354577557	9.892997176	11.90766531	14.63873792	18.39351724
0	0.034204743	0.136800306	0.307731808	0.546895918	0.854115171	1.229177988	1.672000802	2.182716442	2.761621082	3.40902296	4.126107525	4.915913891	5.788207878	6.77231211	7.924650096	9.328689049	11.15644312	13.65341503	17.13861878
0	0.032474092	0.12987654	0.292149492	0.519187288	0.810815484	1.166807157	1.587067868	2.071820267	2.621416558	3.235938054	3.915401782	4.662690363	5.485603014	6.407459971	7.474753517	8.762730697	10.4346226	12.7237279	15.95589353
0	0.031006273	0.124006965	0.278951255	0.495739752	0.774190774	1.114025592	1.515105808	1.977769292	2.50267038	3.089973885	3.73854857	4.449549063	5.232325017	6.108001089	7.115026011	8.319555667	9.876701396	12.00824707	15.0317194
0	0.029951417	0.119789772	0.269471943	0.478908728	0.747918777	1.076185601	1.463502933	1.910194282	2.417168743	2.984911535	3.612111399	4.297934665	5.050629886	5.893315787	6.858914998	8.004081619	9.479302141	11.49657855	14.35546672
0	0.028864165	0.115440518	0.259683851	0.461506568	0.720736899	1.037069221	1.410242053	1.84045709	2.328640892	2.875638658	3.480926049	4.142587957	4.865858562	5.674621944	6.602654442	7.700504288	9.110281227	11.03808779	13.77143061
0	0.027830243	0.111298123	0.250335435	0.444827724	0.694613961	0.999478745	1.359215917	1.773885484	2.244033936	2.770440602	3.353525649	3.992546364	4.690756808	5.468291978	6.362081567	7.421030143	8.778722127	10.63833934	13.27986073
0	0.027090683	0.108329954	0.243618994	0.432799355	0.67570796	0.972228706	1.322300407	1.725949802	2.183324295	2.694707035	3.26076315	3.882531943	4.563577667	5.320468718	6.189996554	7.221211061	8.546016758	10.36352829	12.94766383
0	0.026958931	0.107800633	0.242419447	0.430646461	0.672317512	0.967338719	1.315689235	1.717399137	2.172529603	2.681207753	3.244075387	3.862557008	4.540543696	5.293998031	6.158979708	7.184427995	8.501578426	10.30817508	12.87484453
0	0.027035394	0.108107891	0.243115976	0.431897207	0.674289347	0.970188483	1.319553669	1.72240958	2.178850391	2.689068921	3.253722716	3.874073838	4.553905652	5.309456391	6.176963552	7.205209125	8.525311499	10.33531167	12.90485145
];
thetaRow001=0:0.01:22.5;    % theta 0.01
WRow001Line20=zeros(2251,20);
for k1=1:20
    for k2=1:(22.5/0.01+1)
        WRow001Line20(k2,k1) =interp2(FluxLine20,thetaRow32,Wrow32line20,FluxLine20(k1),thetaRow001(k2),'spline');
    end
end

WdiffRow2250Line20=diff(WRow001Line20,1,1);

TeDeriveThetaofWrow2250line20=-WdiffRow2250Line20/(0.01*2*pi/360);

TeDeriveThetaofWrow50line20=TeDeriveThetaofWrow2250line20(1:45:2250,:);   % Diff of Energy W, row50 line20

thetaRow50=thetaRow001(1:45:2250);  % theta row 50
