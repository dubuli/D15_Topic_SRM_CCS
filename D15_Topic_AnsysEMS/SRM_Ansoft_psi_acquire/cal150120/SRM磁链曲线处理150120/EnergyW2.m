clc;clear;
FLUXSTEP=0.1;
FluxArithPro=0:FLUXSTEP:2.3;    % arithmetic progression,total 20 rows, data of Flux
theta=0:0.9:0.9*25;   % total 26 lines points, the data of theta
Irow26line24=[0,2.89802578086468,5.79587098117603,8.69397105140480,11.5914676924679,14.4876916436439,17.4102021490537,20.3682515492571,23.3195516759108,26.2215486774167,29.0316887021768,31.7143266854484,34.3208925881284,36.9623799784614,39.7509390026866,42.7987198070435,46.2178725377715,50.1205464713152,54.5795879898432,59.5236700073440,64.8484153787966,70.4494469591801,76.2223876034737,82.0628601666563;0,2.88166652173604,5.75943361907870,8.64562945479717,11.5257297600483,14.4056978470247,17.3106555901877,20.2529727371581,23.1903230268224,26.0799594851119,28.8791351379584,31.5503705028250,34.1393631761515,36.7581463715364,39.5205983622719,42.5405974216504,45.9320218229645,49.8087498395065,54.2526531665995,59.1986734797225,64.5396163969882,70.1682839847835,75.9774783094951,81.8600014375097;0,2.82953969628450,5.65191766703213,8.48980913579510,11.3165799657786,14.1448140044384,16.9934277719416,19.8848497965982,22.7773552332485,25.6278886752572,28.3933947159889,31.0325186760527,33.5709276734747,36.1218803183808,38.8045425038605,41.7380801230036,45.0416590688997,48.8344452346385,53.2209569121938,58.1646501822839,63.5501637405902,69.2612757734578,75.1817644672317,81.1954080082571;0,2.73803720527549,5.46796429338783,8.21460198998036,10.9493631905837,13.6868203139339,16.4362268972422,19.2366545924220,22.0501966422445,24.8336113778863,27.5436571305239,30.1370968195881,32.6042715793103,35.0497047614223,37.6021679552948,40.3904327502985,43.5432707358042,47.1894535011825,51.4562702004302,56.3755894569225,61.8275300518964,67.6786966762386,73.7956940208361,80.0451267765758;0,2.60389888265127,5.20257958726525,7.80669301036153,10.4113425013932,13.0148762386554,15.6200611131551,18.2834439393767,20.9819875224306,23.6722958383773,26.3109728632773,28.8546225731910,31.2645413248439,33.5952871965701,35.9871952617163,38.5837927439270,41.5286068668470,44.9651648541210,49.0369939293938,53.8628893359558,59.3710394969531,65.4010425374784,71.7920063421653,78.3830387956474;0,2.41940391514325,4.83927591238969,7.22997622974762,9.67430968035183,12.0885794978243,14.5040567443674,16.9658630825011,19.5031968615181,22.0729787063462,24.6316475174093,27.1356421951313,29.5414016399362,31.8232112270163,34.0859911342213,36.4927223174026,39.2066492629340,42.3910164571893,46.2090683865421,50.8237780378923,56.3038829496161,62.4861283376985,69.1721975072628,76.1637737634327;0,2.16780092890086,4.33727451102511,6.43638470708693,8.67684586470883,10.8283250494560,13.0095642211865,15.2231818208515,17.5498505002986,19.9751781639227,22.4530311035846,24.9372756111452,27.3817779784653,29.7404044974059,31.9944785219114,34.2799637701103,36.7869157243451,39.7054470203016,43.2256702936656,47.5376981801228,52.8220451502761,59.0479902715137,65.9787357822071,73.3689176681908;0,1.77278040810338,3.55222156354219,5.30098661403593,7.04673973439173,9.02281272862927,10.9790868603686,13.0462554044687,15.1796335141386,17.4441114001427,19.8273493157442,22.2832253917306,24.7656177588896,27.2284045480088,29.6254638898759,31.9375701579130,34.3206448842866,37.0007316437247,40.2040602174353,44.1568603866262,49.0853619325054,55.1640410656339,62.2266279968355,69.9690606646369;0,1.26327289439261,2.57017547038627,3.84905676827020,5.21030683982445,6.76951163372953,8.71322913264662,10.6215414107043,12.6717119544803,14.8024415976953,17.0521244304816,19.4201470205983,21.8695281023557,24.3632621544853,26.8643436557188,29.3357670847877,31.7601237920345,34.3042040078878,37.2357476271797,40.8235293996654,45.3363240751001,51.0424131022832,58.0417839286399,66.0214034640819;0,0.931722120197522,1.89362977034310,2.84597173179942,3.80861202405687,4.99277141436333,6.40147249393312,8.29693205164511,10.1828875090037,12.1979108643239,14.3115073421084,16.5426746266112,18.8933995358216,21.3397201633822,23.8572873292228,26.4217518532733,29.0087645554634,31.6073306703716,34.3932956064932,37.6799716913996,41.7838585949965,47.0214559871891,53.6907068120539,61.7084377900689;0,0.741555436932330,1.49522759977167,2.26001107899477,3.00899242296084,3.78328446683972,4.78495170910267,6.00540372495170,7.81719887969254,9.69619999492587,11.6824541337922,13.7857093920209,15.9940641462610,18.3233886081621,20.7676496135879,23.3197025403143,25.9724027661172,28.7186056687726,31.5611540718186,34.6912982436612,38.4682584880624,43.2571381721240,49.4230406629475,57.2148427670491;0,0.619526221821602,1.24246182741466,1.87656069524793,2.50900511376633,3.12675538058733,3.78022167909121,4.63400298813928,5.68966319051763,7.31581906789270,9.19074971823790,11.1354736703544,13.2324694956325,15.4395026152513,17.7529733816357,20.1903666129466,22.7747018400540,25.5289985938281,28.4762764051390,31.6479496696618,35.2603164055306,39.7101151975128,45.4015907191838,52.7320632659750;0,0.532019950812698,1.06452825063780,1.60526102269041,2.14917586714593,2.68789282568150,3.21363517405046,3.78481410041117,4.53029476609950,5.44926177325065,6.85013007288063,8.68290062247515,10.5918892637640,12.6708123879832,14.8683196489181,17.1656618425377,19.5953729695863,22.2242706094300,25.1191792210167,28.3469232632949,31.9830062261102,36.2774492403764,41.6418902905151,48.4940614630533;0,0.465620834629775,0.930789728383839,1.40064966373695,1.87448604277636,2.34823421014245,2.81548555139212,3.27270101349921,3.77862376853655,4.43341401451414,5.24999470112630,6.43494543705020,8.16817199140187,10.0442807566181,12.0987441241925,14.2976826651838,16.6231090428714,19.1109964509359,21.8719900857923,25.0180441792840,28.6611129632543,32.9275011043904,38.1095687710128,44.6064450177724;0,0.415509515674386,0.830516904552059,1.24754436021525,1.66748777824464,2.08882141847688,2.50876034121242,2.92193415289256,3.33016187143737,3.78948203904352,4.37598981298113,5.11277656008875,6.12845630747080,7.69961728121055,9.52512006874939,11.5466765182031,13.7503388170916,16.1407282292680,18.7466094396395,21.7275298653079,25.2532946083514,29.4937087708478,34.6370057858706,40.9734574723187;0,0.374660793654721,0.748905370331268,1.12399551239114,1.50113668212580,1.87974591608740,2.25888907672142,2.63550628714494,3.00522449075855,3.37504010194202,3.79559015683521,4.32594719664295,4.99301547599111,5.87677822306435,7.27877861731628,9.03233782030601,11.0232061333968,13.2631499374864,15.7913779792470,18.5904916611738,21.8800602114421,25.9268595527098,30.9975578528802,37.3286914616463;0,0.341606438600076,0.682974980978967,1.02450046892896,1.36693605202646,1.71035311609029,2.05467924665763,2.39899862595423,2.74028013731272,3.07526435792095,3.41583554840119,3.80524679533375,4.28975382056113,4.90049258603947,5.69441994458987,6.93006417570863,8.59416851586154,10.5764604925781,12.9194513992407,15.6063342489428,18.6781730178382,22.4546550578621,27.2940390424288,33.5433472832635;0,0.313601867018736,0.627066297512769,0.940476940023757,1.25418413235113,1.56843916644415,1.88344212424576,2.19927159773432,2.51439510291593,2.82613647330574,3.13234475733158,3.44847625819287,3.81089651136325,4.25689343707241,4.81830855163370,5.54210450527621,6.65526071902147,8.25363144721734,10.2817764520345,12.7494879115453,15.6264282585787,19.1597901130267,23.7282185488987,29.7421316481393;0,0.290494469581662,0.580948550748946,0.871296459766301,1.16144101585772,1.45153422447932,1.74194719519206,2.03305767581235,2.32472523652225,2.61532879621812,2.90298451652207,3.18731646087247,3.48595977418310,3.82840256152602,4.24466040584497,4.77033753985438,5.45807567305363,6.51849832187020,8.10913742129945,10.1920849905263,12.8155171929082,16.3084897645513,20.5886642508611,26.1574462772021;0,0.270367910712272,0.540759207646954,0.811083459326931,1.08096270513767,1.35031692906246,1.61964901012756,1.88951823951803,2.16040515576761,2.43157210922959,2.70132289669541,2.96793542624437,3.23282628762083,3.51553764664851,3.84210383815326,4.23931075427833,4.74617546403546,5.42435962023701,6.52787745771673,8.17143767682117,10.3322365392900,13.5376028089497,17.7161545699154,22.9394411907087;0,0.253114781562319,0.506265981850872,0.759394398589872,1.01208571560989,1.26404216199381,1.51565557769693,1.76746710194617,2.02001772814456,2.27347887258848,2.52685427030989,2.77891760429764,3.02844842771848,3.27959597439751,3.55179663825201,3.86718919438693,4.25123893456162,4.77405578824283,5.54384350291945,6.73754828032167,8.49699518999743,11.1715058948310,15.0510164500607,20.0529561335243;0,0.238388596464479,0.476876833479871,0.715450634075119,0.953486600582940,1.19032028659028,1.42647027480073,1.66297948218701,1.90089317380350,2.14112829613625,2.38257273090536,2.62249466543903,2.85811714800388,3.08697747903302,3.32009958474682,3.58679935451840,3.91769606705934,4.34914555959267,4.96193896718440,5.86396127021560,7.23795189630095,9.51498226436366,12.8867035760685,17.5026240042688;0,0.225396229493115,0.451018863906198,0.676957640366038,0.902235697269529,1.12547737760280,1.34708079484220,1.56894946189460,1.79303448316861,2.02128599008916,2.25404388826505,2.48675385184060,2.71393511010559,2.93010689234978,3.13247593659849,3.35018825119393,3.63333168102894,4.03235618001273,4.58911808527560,5.32281610584471,6.44509502181788,8.41041217750035,11.4221256022515,15.5515181436274;0,0.214677084616642,0.429617566965396,0.644985417787975,0.859815022962132,1.07245071123092,1.28271337965419,1.49267566848371,1.70459767125602,1.92073948150771,2.14298746614813,2.36843594275472,2.59086092239414,2.80397197422993,3.00147867352965,3.18987199205588,3.42557442935839,3.77719979211454,4.30950586526870,5.01121390596884,5.95976855253545,7.73398483566598,10.5228095878640,14.3245794916226;0,0.208128581276669,0.416501456037326,0.625295485415686,0.833678039838804,1.04004357970885,1.24377187548263,1.44651632898198,1.65024278245022,1.85691707813065,2.06846861578242,2.28442682099234,2.50047295610914,2.71194180753671,2.91416816167894,3.10475992239272,3.32226064215870,3.64069081006699,4.13489500369625,4.82952403702274,5.73208065838748,7.41371382887915,10.0689534321005,13.7069477717440;0,0.206691620837031,0.413623192460608,0.620973217254540,0.827936673697547,1.03291968553317,1.23520050150322,1.43628227306542,1.63800822415362,1.84222157870163,2.05075197792332,2.26362981326372,2.47730400071671,2.68779955046651,2.89114147269731,3.08450206842440,3.30028001625599,3.61184753908021,4.09476251421996,4.78327861670859,5.67880540168991,7.33865222563729,9.96569192933458,13.5338491023817];
[m2,n2]=size(Irow26line24);
Wrow26line24=zeros(m2,n2);  % energy

for k1=1:m2 % row    
    Irow26line24Row=Irow26line24(k1,:);
    i_handle=@(x)interp1(FluxArithPro,Irow26line24Row,x,'spline');
    
    for k2=1:n2-1
       %Wrow32line20(k1,k2+1)=quad(i_handle,0,k2*0.08); % integral of the i*d(Psi)
       Wrow26line24(k1,k2+1)=integral(i_handle,0,k2*FLUXSTEP); % integral of the i*d(Psi) % almost no change with the upper command
    end
end